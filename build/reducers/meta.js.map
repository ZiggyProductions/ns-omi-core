{"version":3,"sources":["../../src/reducers/meta.js"],"names":["_","require","module","exports","state","action","undefined","score","type","n","clone","round","drawpoint","reduce","rounds","s","r","cards","tricks","first"],"mappings":";;AAAA;;;AAGA,IAAMA,IAAIC,QAAQ,YAAR,CAAV;AACAC,OAAOC,OAAP,GAAiB,UAAUC,KAAV,EAAiBC,MAAjB,EAA0B;AACvC,QAAGC,cAAcF,KAAjB,EACI,OAAO;AACH;AACA;AACA;AACAG,eAAM,EAAC,GAAE,CAAH,EAAK,GAAE,CAAP;AAJH,KAAP;AAMJ,YAAQF,OAAOG,IAAf;AACI,aAAK,gBAAL;AAAuB;AACnB,gBAAIC,IAAIT,EAAEU,KAAF,CAAQN,KAAR,CAAR;AACAK,cAAEE,KAAF,GAAUN,OAAOM,KAAjB;AACA,mBAAOF,CAAP;AACJ,aAAK,cAAL;AACI,gBAAIA,IAAIT,EAAEU,KAAF,CAAQN,KAAR,CAAR;AACA,gBAAIQ,YAAY,CAAhB;AACA,gBAAIL,QAAQP,EAAEa,MAAF,CAASR,OAAOS,MAAhB,EAAuB,UAACC,CAAD,EAAGC,CAAH,EAAO;AACtC,oBAAGA,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,KAA2BS,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,CAA9B,EAAuD;AACnDK;AACA,2BAAOG,CAAP;AACH;;AAED,oBAAIC,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,KAA2B,CAA/B,EAAkC;AAAE;AAChCQ,sBAAE,CAAF,KAAQ,CAACC,EAAEG,KAAF,IAAW,CAAX,GAAe,CAAf,GAAmB,CAApB,IAAyBP,SAAjC;AACAA,gCAAY,CAAZ;AACA,2BAAOG,CAAP;AACH;;AAED,oBAAIC,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,KAA2B,CAA/B,EAAkC;AAAE;AAChCQ,sBAAE,CAAF,KAAQ,CAACC,EAAEG,KAAF,IAAW,CAAX,GAAe,CAAf,GAAmB,CAApB,IAAyBP,SAAjC;AACAA,gCAAY,CAAZ;AACA,2BAAOG,CAAP;AACH;;AAED,oBAAGC,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,IAA0BS,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,CAA7B,EAAqD;AACjDQ,sBAAE,CAAF,KAAQ,CAACC,EAAEG,KAAF,IAAW,CAAX,GAAe,CAAf,GAAmB,CAApB,IAAyBP,SAAjC;AACAA,gCAAY,CAAZ;AACA,2BAAOG,CAAP;AACH;;AAED,oBAAGC,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,IAA0BS,EAAEC,KAAF,CAAQC,MAAR,CAAeX,KAAf,CAAqB,CAArB,CAA7B,EAAqD;AACjDQ,sBAAE,CAAF,KAAQ,CAACC,EAAEG,KAAF,IAAW,CAAX,GAAe,CAAf,GAAmB,CAApB,IAAyBP,SAAjC;AACAA,gCAAY,CAAZ;AACA,2BAAOG,CAAP;AACH;AACD,uBAAOA,CAAP;AACH,aA9BW,EA8BV,EAAC,GAAE,CAAH,EAAK,GAAE,CAAP,EA9BU,CAAZ;AA+BAN,cAAEF,KAAF,GAAUA,KAAV;AACA,mBAAOE,CAAP;AACJ;AACI,mBAAOL,KAAP;AA1CR;AA4CH,CApDD","file":"meta.js","sourcesContent":["/**\n * Created by GAZ on 7/7/17.\n */\nconst _ = require('underscore');\nmodule.exports = function (state, action)  {\n    if(undefined === state)\n        return {\n            // round:0,\n            // turn:0,\n            // trump:0, // none, clubs, diamonds, spades, hearts\n            score:{1:0,2:0}\n        };\n    switch (action.type) {\n        case 'SET_META_ROUND': // discontinued\n            var n = _.clone(state);\n            n.round = action.round;\n            return n;\n        case 'UPDATE_SCORE':\n            var n = _.clone(state);\n            var drawpoint = 0;\n            var score = _.reduce(action.rounds,(s,r)=>{\n                if(r.cards.tricks.score[1] == r.cards.tricks.score[2]) {\n                    drawpoint++;\n                    return s;\n                }\n\n                if (r.cards.tricks.score[1] == 8) { // kapothi\n                    s[1] += (r.first == 1 ? 3 : 4) + drawpoint;\n                    drawpoint = 0;\n                    return s;\n                }\n\n                if (r.cards.tricks.score[2] == 8) { // kapothi\n                    s[2] += (r.first == 2 ? 3 : 4) + drawpoint;\n                    drawpoint = 0;\n                    return s;\n                }\n\n                if(r.cards.tricks.score[1] > r.cards.tricks.score[2]){\n                    s[1] += (r.first == 1 ? 1 : 2) + drawpoint;\n                    drawpoint = 0;\n                    return s;\n                }\n\n                if(r.cards.tricks.score[2] > r.cards.tricks.score[1]){\n                    s[2] += (r.first == 2 ? 1 : 2) + drawpoint;\n                    drawpoint = 0;\n                    return s;\n                }\n                return s;\n            },{1:0,2:0});\n            n.score = score;\n            return n;\n        default:\n            return state;\n    }\n}\n\n"]}